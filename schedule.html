<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>循环时间表</title>
    <!-- Tailwind CSS v3 -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome -->
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#3b82f6',
                        secondary: '#64748b',
                        accent: '#f97316',
                        success: '#10b981',
                        warning: '#f59e0b',
                        danger: '#ef4444',
                        light: '#f8fafc',
                        dark: '#1e293b'
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.5s ease-in-out',
                        'slide-up': 'slideUp 0.5s ease-in-out',
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': { opacity: '0' },
                            '100%': { opacity: '1' },
                        },
                        slideUp: {
                            '0%': { transform: 'translateY(20px)', opacity: '0' },
                            '100%': { transform: 'translateY(0)', opacity: '1' },
                        }
                    }
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .glass {
                background: rgba(255, 255, 255, 0.25);
                backdrop-filter: blur(10px);
                -webkit-backdrop-filter: blur(10px);
                border: 1px solid rgba(255, 255, 255, 0.18);
            }
            .glass-dark {
                background: rgba(30, 41, 59, 0.75);
                backdrop-filter: blur(10px);
                -webkit-backdrop-filter: blur(10px);
                border: 1px solid rgba(255, 255, 255, 0.08);
            }
            .text-shadow {
                text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            }
            .transition-all-300 {
                transition: all 300ms ease-in-out;
            }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-gray-900 dark:to-gray-800 min-h-screen font-sans text-gray-800 dark:text-gray-200">
    <div class="container mx-auto px-4 py-8 max-w-4xl">
        <!-- 头部 -->
        <header class="text-center mb-10 animate-fade-in">
            <h1 class="text-4xl font-bold text-primary dark:text-blue-400 mb-2 text-shadow">循环时间表</h1>
        </header>

        <!-- 日期选择器 -->
        <div class="glass rounded-xl p-6 mb-8 shadow-lg animate-slide-up">
            <div class="flex flex-col md:flex-row items-center justify-between gap-4">
                <div class="flex-1">
                    <label for="date-input" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">选择日期</label>
                    <div class="relative">
                        <input type="date" id="date-input" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 focus:ring-2 focus:ring-primary dark:focus:ring-blue-500 focus:border-transparent transition-all-300">
                        <span class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                            <i class="fa fa-calendar text-gray-400"></i>
                        </span>
                    </div>
                </div>
                <div class="flex gap-3">
                    <button id="today-btn" class="px-4 py-2 bg-primary hover:bg-blue-600 text-white rounded-lg shadow transition-all-300 flex items-center justify-center">
                        <i class="fa fa-calendar-check-o mr-2"></i>今天
                    </button>
                    <button id="search-btn" class="px-4 py-2 bg-accent hover:bg-orange-600 text-white rounded-lg shadow transition-all-300 flex items-center justify-center">
                        <i class="fa fa-search mr-2"></i>查询
                    </button>
                </div>
            </div>
        </div>

        <!-- 日期信息展示 -->
        <div id="date-info" class="mb-6 text-center animate-fade-in">
            <h2 class="text-2xl font-bold mb-2">2025年9月30日</h2>
            <p class="text-lg text-primary dark:text-blue-400">时间表中的第一天</p>
        </div>

        <!-- 时间表展示 -->
        <div id="schedule-container" class="glass rounded-xl p-6 shadow-lg animate-slide-up">
            <h3 class="text-xl font-semibold mb-4 flex items-center">
                <i class="fa fa-clock-o text-primary dark:text-blue-400 mr-2"></i>时间安排
            </h3>
            <div class="space-y-4">
                <!-- 时间块将通过JavaScript动态生成 -->
                <div class="bg-white dark:bg-gray-700 rounded-lg p-4 shadow-sm hover:shadow-md transition-all-300 border-l-4 border-primary">
                    <div class="flex justify-between items-center">
                        <span class="font-medium">0:00 - 2:00</span>
                        <span class="text-sm text-secondary dark:text-gray-400">时间段1</span>
                    </div>
                </div>
                <div class="bg-white dark:bg-gray-700 rounded-lg p-4 shadow-sm hover:shadow-md transition-all-300 border-l-4 border-primary">
                    <div class="flex justify-between items-center">
                        <span class="font-medium">9:00 - 12:00</span>
                        <span class="text-sm text-secondary dark:text-gray-400">时间段2</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- 未来几天预览 -->
        <div class="mt-10 animate-fade-in">
            <h3 class="text-xl font-semibold mb-4 flex items-center">
                <i class="fa fa-calendar-o text-primary dark:text-blue-400 mr-2"></i>未来几天预览
            </h3>
            <div id="preview-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4">
                <!-- 未来几天的时间安排将通过JavaScript动态生成 -->
            </div>
        </div>

    </div>

    <script>
        // 时间表数据
        const scheduleData = [
            { day: 1, times: ["0:00 - 2:00", "9:00 - 12:00"], label: "第一天" },
            { day: 2, times: ["8:00 - 10:00", "21:00 - 24:00"], label: "第二天" },
            { day: 3, times: ["6:00 - 8:00", "18:00 - 21:00"], label: "第三天" },
            { day: 4, times: ["4:00 - 6:00", "15:00 - 18:00"], label: "第四天" },
            { day: 5, times: ["2:00 - 4:00", "12:00 - 15:00"], label: "第五天" }
        ];

        // 基准日期：2025年9月30日（时间表中的第一天）
        const baseDate = new Date(2025, 8, 30); // 月份是0-based，所以9月是8

        // DOM元素
        const dateInput = document.getElementById('date-input');
        const todayBtn = document.getElementById('today-btn');
        const searchBtn = document.getElementById('search-btn');
        const dateInfo = document.getElementById('date-info');
        const scheduleContainer = document.getElementById('schedule-container').querySelector('.space-y-4');
        const previewContainer = document.getElementById('preview-container');

        // 初始化页面
        function initPage() {
            // 设置今天的日期为默认值
            const today = new Date();
            const formattedDate = formatDateForInput(today);
            dateInput.value = formattedDate;

            // 显示今天的时间表
            showSchedule(today);

            // 生成未来几天的预览
            generatePreview(today);

            // 添加事件监听器
            todayBtn.addEventListener('click', () => {
                const today = new Date();
                dateInput.value = formatDateForInput(today);
                showSchedule(today);
                generatePreview(today);
            });

            searchBtn.addEventListener('click', () => {
                const selectedDate = new Date(dateInput.value);
                if (!isNaN(selectedDate.getTime())) {
                    showSchedule(selectedDate);
                    generatePreview(selectedDate);
                } else {
                    alert('请选择有效的日期');
                }
            });

            dateInput.addEventListener('change', () => {
                const selectedDate = new Date(dateInput.value);
                if (!isNaN(selectedDate.getTime())) {
                    showSchedule(selectedDate);
                    generatePreview(selectedDate);
                }
            });
        }

        // 显示指定日期的时间表
        function showSchedule(date) {
            // 计算与基准日期的差值（天数）
            const diffTime = date.getTime() - baseDate.getTime();
            const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));

            // 计算是循环中的第几天（1-5）
            let cycleDay = (diffDays % 5) + 1;
            if (cycleDay <= 0) cycleDay += 5; // 处理负数情况

            // 获取对应的时间表
            const schedule = scheduleData.find(item => item.day === cycleDay);

            // 更新日期信息
            const formattedDate = formatDateForDisplay(date);
            dateInfo.innerHTML = `
                <h2 class="text-2xl font-bold mb-2">${formattedDate}</h2>
                <p class="text-lg text-primary dark:text-blue-400">时间表中的${schedule.label}</p>
            `;

            // 更新时间表
            scheduleContainer.innerHTML = '';
            schedule.times.forEach((time, index) => {
                const timeBlock = document.createElement('div');
                timeBlock.className = 'bg-white dark:bg-gray-700 rounded-lg p-4 shadow-sm hover:shadow-md transition-all-300 border-l-4 border-primary animate-fade-in';
                timeBlock.style.animationDelay = `${index * 0.1}s`;
                timeBlock.innerHTML = `
                    <div class="flex justify-between items-center">
                        <span class="font-medium">${time}</span>
                        <span class="text-sm text-secondary dark:text-gray-400">时间段${index + 1}</span>
                    </div>
                `;
                scheduleContainer.appendChild(timeBlock);
            });
        }

        // 生成未来几天的预览
        function generatePreview(startDate) {
            previewContainer.innerHTML = '';
            
            for (let i = 0; i < 5; i++) {
                const currentDate = new Date(startDate);
                currentDate.setDate(startDate.getDate() + i);
                
                // 计算与基准日期的差值（天数）
                const diffTime = currentDate.getTime() - baseDate.getTime();
                const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));

                // 计算是循环中的第几天（1-5）
                let cycleDay = (diffDays % 5) + 1;
                if (cycleDay <= 0) cycleDay += 5; // 处理负数情况

                // 获取对应的时间表
                const schedule = scheduleData.find(item => item.day === cycleDay);

                // 创建预览卡片
                const previewCard = document.createElement('div');
                previewCard.className = `glass rounded-lg p-4 shadow transition-all-300 hover:shadow-lg cursor-pointer ${i === 0 ? 'ring-2 ring-primary dark:ring-blue-400' : ''}`;
                previewCard.style.animationDelay = `${i * 0.1}s`;
                previewCard.style.animation = 'fadeIn 0.5s ease-in-out forwards';
                
                // 格式化日期显示
                const isToday = i === 0 && isSameDay(currentDate, new Date());
                const dateDisplay = isToday ? '今天' : formatDateForPreview(currentDate);
                
                // 设置卡片内容
                previewCard.innerHTML = `
                    <h4 class="font-semibold mb-2 ${isToday ? 'text-primary dark:text-blue-400' : ''}">${dateDisplay}</h4>
                    <p class="text-sm text-secondary dark:text-gray-400 mb-3">${schedule.label}</p>
                    <div class="space-y-2">
                        ${schedule.times.map(time => `
                            <div class="text-sm bg-white/50 dark:bg-gray-700/50 rounded p-2">${time}</div>
                        `).join('')}
                    </div>
                `;
                
                // 添加点击事件
                previewCard.addEventListener('click', () => {
                    dateInput.value = formatDateForInput(currentDate);
                    showSchedule(currentDate);
                    
                    // 更新选中状态
                    document.querySelectorAll('#preview-container > div').forEach(card => {
                        card.classList.remove('ring-2', 'ring-primary', 'dark:ring-blue-400');
                    });
                    previewCard.classList.add('ring-2', 'ring-primary', 'dark:ring-blue-400');
                });
                
                previewContainer.appendChild(previewCard);
            }
        }

        // 辅助函数：格式化日期为输入框格式（YYYY-MM-DD）
        function formatDateForInput(date) {
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            return `${year}-${month}-${day}`;
        }

        // 辅助函数：格式化日期为显示格式（YYYY年MM月DD日 星期X）
        function formatDateForDisplay(date) {
            const year = date.getFullYear();
            const month = date.getMonth() + 1;
            const day = date.getDate();
            const weekdays = ['日', '一', '二', '三', '四', '五', '六'];
            const weekday = weekdays[date.getDay()];
            return `${year}年${month}月${day}日 星期${weekday}`;
        }

        // 辅助函数：格式化日期为预览格式（MM-DD 星期X）
        function formatDateForPreview(date) {
            const month = date.getMonth() + 1;
            const day = date.getDate();
            const weekdays = ['日', '一', '二', '三', '四', '五', '六'];
            const weekday = weekdays[date.getDay()];
            return `${month}-${day} 星期${weekday}`;
        }

        // 辅助函数：判断两个日期是否为同一天
        function isSameDay(date1, date2) {
            return date1.getFullYear() === date2.getFullYear() &&
                   date1.getMonth() === date2.getMonth() &&
                   date1.getDate() === date2.getDate();
        }

        // 页面加载完成后初始化
        document.addEventListener('DOMContentLoaded', initPage);
    </script>
</body>
</html>
